<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MiniPeace</title>
  <link rel="icon" href="favicon.png?v=2" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
  <link rel="manifest" href="/manifest.json">

  <style>
/* Loading Screen */
/* màn hình loading */
#loading-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 250, 240, 1); 
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  overflow: hidden;
}

/* hiệu ứng nền di chuyển */
#loading-screen::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 200%;
  height: 100%;
  background: repeating-linear-gradient(
    -45deg,
    #9297ba,
    #5478d2 5px,
    #223f8a 5px,
    #344aef 10px
  );
opacity: 0.1;
  animation: slide-bg 3s linear infinite;
  z-index: 0;
}

/* Nội dung loading căn giữa */
#loading-screen .loading-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 2;
}

#loading-screen .loading-text {
  font-family: 'Oswald', sans-serif;
  font-size: 2rem;
  color: #223f8a;
  margin-bottom: 20px;
  z-index: 2;
}

/* Fade out toàn bộ màn loading */
#loading-screen.hidden {
  opacity: 0;
  transition: opacity 1s ease;
  pointer-events: none;
}

/* gif nhân vật */
#loading-screen img {
  position: relative;
  z-index: 1;
  width: 600 px;
  height: auto;
}

/* keyframes cho nền */
@keyframes slide-bg {
  0%   { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}


/* Hiệu ứng riêng cho ảnh gif */
#loading-screen img {
z-index: 10;
  max-height: 80vh;
  max-width: 80vw;
  object-fit: contain;
  transition: transform 2s ease, opacity 1.2s ease; /* chậm hơn nền */
}

/* Khi ẩn thì ảnh di chuyển sang phải + mờ dần */
#loading-screen.hidden img {
  transform: translateX(100vw); 
  opacity: 0;
}


    /* ======================
       RESET & BASE
       ====================== */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: repeating-linear-gradient(90deg, #dbeafe 0 20px, #bfdbfe 20px 40px),
                  repeating-linear-gradient(0deg, #dbeafe 0 20px, #bfdbfe 20px 40px);
      background-blend-mode: overlay;
      min-height: 100vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      text-align: center;
      padding: 40px 20px 20px;
      cursor: url('assets/tay.png') 16 16, default;
    }

    /* custom cursor states */
    .element-grab { cursor: url('assets/cam.png'), grab; }
    .element-grabbing { cursor: url('assets/nam.png'), grabbing; }

    /* CONTENT CONTAINER */
    .content {
      position: relative;
      z-index: 2;
      background-color: rgba(255, 250, 240, 0.7);
      padding: 0;
      margin: 0;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      max-width: 90vw;
      min-width: 320px;
      overflow: hidden;
    }

    /* overlay container (reused for pages) */
    .overlay-container {
      position: relative;
      width: 80vw;
      aspect-ratio: 16/9;
      padding: 0;
      overflow: hidden;
    }
    .overlay-container .layer {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
    }

    /* Particles for fireworks */
    .particle {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      cursor: url('assets/chi.png') 16 16, pointer;
      pointer-events: none;
      opacity: 1;
      z-index: 2;
      filter: blur(1px);
      animation: fall 2s forwards, sparkle 1s infinite alternate;
    }
    @keyframes fall {
      to {
        transform: translate(var(--dx), var(--dy));
        opacity: 0;
        filter: blur(3px);
      }
    }
    @keyframes sparkle {
      0% { box-shadow: 0 0 3px #fff, 0 0 6px #fff; }
      50% { box-shadow: 0 0 6px #fff, 0 0 12px #fff; }
      100% { box-shadow: 0 0 3px #fff, 0 0 6px #fff; }
    }

    /* Commission button (kept absolute as before) */
    #btn-commission {
      position: absolute;
      left: 70%;
      top: 44%;
      transform: translate(-50%, -50%);
      padding: 3%;
      cursor: url('assets/chi.png') 16 16, pointer;
      z-index: 10;
      opacity: 0;
    }

/* Animation lắc lư cho commission.png */
@keyframes sway {
  0%   { transform: rotate(0deg); }
  25%  { transform: rotate(5deg); }
  50%  { transform: rotate(-5deg); }
  75%  { transform: rotate(5deg); }
  100% { transform: rotate(0deg); }
}

#commission.swaying {
  transform-origin: 70.8% 38%;  /* tâm xoay */
  animation: sway 0.8s ease-in-out infinite;
}


    /* Page-specific classes (kept for markup parity) */
    .overlay-container.Page2,
    .overlay-container.Page3,
    .overlay-container.Page4,
    .overlay-container.Page5 { position: relative; width: 80vw; aspect-ratio: 16/9; }

    /* Awards (page3) - invisible buttons over trophies */
    .awards { position: absolute; width: 100%; height: 100%; z-index: 30; }
    .award-item button {
      position: absolute;
      width: 10%;
      height: 22%;
      background: transparent;
      border: none;
      opacity: 0;
      cursor: url('assets/chi.png') 16 16, pointer;
      transform: translate(-50%, -50%);
    }
    #btn-read-wow { left: 36%; top: 53%; }
    #btn-read-kaia { left: 49%; top: 53%; }
    #btn-read-ava { left: 63%; top: 53%; }

    /* Theme toggle button (hidden but clickable) */
    #theme-toggle {
      position: absolute;
      left: 86.5%;
      top: 41%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      background: transparent;
      border: none;
      cursor: url('assets/chi.png') 16 16, pointer;
      opacity: 0;
      pointer-events: auto;
      z-index: 9999;
    }

    /* Videos (page4) - iframe positioning */
    .overlay-container.Page4 .videos { position: absolute; inset: 0; cursor: url('assets/chi.png') 16 16, pointer; pointer-events: none; }
    .videos iframe {
      position: absolute;
      transform: translate(-50%, -50%);
      width: 16%;
      height: 28%;
      border: none;
      z-index: 20;
      cursor: url('assets/chi.png') 16 16, pointer;
      pointer-events: auto; /* allow interaction with iframe */
    }
    /* video positions (center points) */
    #v1a { left: 28%; top: 36%; }
    #v1b { left: 50%; top: 36%; }
    #v1c { left: 72%; top: 36%; }
    #v2a { left: 28%; top: 72%; }
    #v2b { left: 50%; top: 72%; }
    #v2c { left: 72%; top: 72%; }

.videos .thumb-wrap {
  position: absolute;
  transform: translate(-50%, -50%);
  width: 16%;
  height: 28%;
  z-index: 20;
  cursor: url('assets/chi.png') 16 16, pointer;
  pointer-events: auto; /* ✅ cho phép click lại */
}


.videos .thumb-wrap img.video-thumb {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border: none;
  display: block;
}
.videos .thumb-wrap .yt-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 48px;
  color: red;
  background: white;         /* nền trắng */
  border-radius: 12px;       /* bo góc (12px = logo vuông bo góc YouTube) */
  padding: 0px 6px;         /* khoảng cách để tam giác không sát viền */
  box-shadow: 0 2px 2px rgba(0,0,0,0.3); /* tạo chiều sâu */
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
}
.videos .thumb-wrap:hover .yt-icon {
  transform: translate(-50%, -50%) scale(1.2); /* phóng to 1.2 lần */
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);      /* đổ bóng đậm hơn */
}

/* Overlay */
#videoOverlay {
  display: none; /* ẩn mặc định */
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.85);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}

#videoOverlay .overlay-content {
  position: relative;
  width: 80%;
  max-width: 900px;
}

#videoOverlay iframe {
  width: 100%;
  height: 500px;
  border-radius: 12px;
  box-shadow: 0 0 20px #000;
}

#closeOverlay {
  position: absolute;
  top: -40px; right: -20px;
  font-size: 40px;
  font-weight: bold;
  color: white;
  cursor: pointer;
}


    /* sparkles overlay (dark-mode only) */
    .gold-sparkles { position: fixed; inset: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; overflow: hidden; display: none; }
    #gold-sparkles { display: none; }
    .sparkle {
      position: absolute; border-radius: 50%; background-color: #f8c365; opacity: 1;
      animation: floatSparkle linear infinite; filter: blur(1px);
    }
    .sparkle.faint { opacity: 0.7; filter: blur(1.2px) brightness(1.1); transform: scale(0.8); }

    @keyframes floatRandom {
      0%   { transform: translate(0, 0); opacity: 0.8; }
      50%  { transform: translate(var(--x-move), -50vh); opacity: 1; }
      100% { transform: translate(calc(var(--x-move) / 2), -120vh); opacity: 0; }
    }

    /* Comic viewer (full-screen modal) */
    .comic-viewer {
      position: fixed; inset: 0; width: 100vw; height: 100vh;
      background: rgba(0, 0, 0, 0.85); display: flex; justify-content: center; align-items: center;
      z-index: 10000; overflow: hidden;
    }
    .comic-blur-bg { position: absolute; inset: 0; width: 100%; height: 100%; backdrop-filter: blur(10px); z-index: 0; }
    .comic-deck { display: flex; justify-content: center; align-items: center; position: relative; z-index: 1; width: 100%; height: 100%; cursor: url('assets/chi.png'), pointer; }
    .comic-deck img {
      position: absolute; height: 100%; max-width: 90vw; max-height: 90vh; width: auto;
      transition: transform .5s ease-in-out, filter .6s ease-in-out, opacity .6s ease-in-out;
      transition-delay: 0.05s; border-radius: 8px;
    }
    .comic-deck img.active { transform: scale(1) translateX(0); filter: brightness(1) contrast(1); z-index: 2; }
    .comic-deck img.left { transform: scale(0.85) translateX(-696px) rotateY(5deg); filter: brightness(0.6) contrast(0.8); z-index: 1; }
    .comic-deck img.right { transform: scale(0.85) translateX(696px) rotateY(-5deg); filter: brightness(0.6) contrast(0.8); z-index: 1; }

    .close-btn {
      position: absolute; top: 20px; right: 30px; font-size: 2em; background: none; border: none; color: white;
      cursor: url('assets/chi.png')16 16, pointer; z-index: 10; transition: transform 0.2s ease;
    }
    .close-btn:hover { transform: scale(1.2); }

/* Audio icon */
/* Audio icon */
#audio-trigger {
   position: absolute; top: 30px; right: 90px; font-size: 2em; background: none; border: none; color: white;
      cursor: url('assets/chi.png')16 16, pointer; z-index: 10; transition: transform 0.2s ease;
}

#audio-trigger.active i {
  color: #f27b84; /* màu khi đang bật nhạc */ cursor: url('assets/chi.png')16 16, pointer;
}

#audio-trigger:hover {
  transform: scale(1.2);
}

/* Hint nhạc: bảng nhỏ riêng, mặc định ẩn */
#audio-hint {
  position: absolute;
  top: 30px;           /* cùng top với close-btn */
  right: 150px; 
  background: rgba(0,0,0,0.7);
  color: #fff;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 14px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  z-index: 12;
  transition: opacity 0.3s ease;
}

#audio-hint.show {
  opacity: 1;
}

    /* Icons overlay (links on Page1) */
    .icons-overlay {
      position: absolute; left: 24%; top: 55%; width: 31%; transform: translateY(-50%);
      display: flex; justify-content: space-between; align-items: center; z-index: 9999;
      font-size: min(3vw, 3vh);
    }
    .icons-overlay a { flex:1; text-align:center; color:#0c2f4d; cursor: url('assets/chi.png'), pointer; transition: transform .16s ease, color .16s ease; }
    .icons-overlay a:hover { transform: scale(1.15); color: #f27b84; }

    /* Floating icons (left side) */
    .floating-icons {
      position: fixed; top: 50%; left: 16px; transform: translateY(-50%); display: flex; flex-direction: column; gap: 20px;
      font-size: 32px; z-index: 999; opacity: 0; transition: opacity 0.4s ease;
    }
    .floating-icons.visible { opacity: 1; pointer-events: auto; cursor: url('assets/chi.png') 16 16, pointer; }
    .floating-icons a { color: #0c2f4d; transition: transform 0.2s ease, color 0.2s ease; }
    .floating-icons a:hover { transform: scale(1.3); color: #f27b84; cursor: url('assets/chi.png') 16 16, pointer; }

    /* Gmail & Discord tooltip */
/* Mỗi icon làm gốc tọa độ cho tooltip */
.icons-overlay a,
.floating-icons a {
  position: relative;
  display: inline-block; /* hoặc block nếu muốn full vùng click */
}

/* Tooltip riêng cho overlay */
.icons-overlay .copy-note-overlay {
  position: absolute;
  bottom: 120%; /* nằm phía trên icon */
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  color: #f8c365;
  background: rgba(0,0,0,0.7);
  padding: 2px 6px;
  border-radius: 4px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}
.icons-overlay .show-note .copy-note-overlay {
  opacity: 1;
}

/* Tooltip riêng cho floating-icons */
.floating-icons .copy-note-floating {
  position: absolute;
  left: 110%; /* nằm bên phải icon */
  top: 50%;
  transform: translateY(-50%);
  font-size: 12px;
  color: #f27b84;
  background: rgba(0,0,0,0.7);
  padding: 2px 6px;
  border-radius: 4px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}
.floating-icons .show-note .copy-note-floating {
  opacity: 1;
  transform: translateY(-50%) translateX(5px); /* hiệu ứng trượt nhẹ */
}


    /* Responsive tweaks */
    @media (max-width: 768px) {
      body { padding: 5px 1px; }
      .content { max-width: 85vw; left: 10px;}
      .overlay-container { width: 100%; max-width: 100%; aspect-ratio: 16/9; }
      .icons-overlay { display: none !important; }
      .floating-icons { left: 10px; font-size: 1.3em; opacity: 1; pointer-events: auto; }
      .comic-deck img { width: 100%; height: auto; max-width: 90vw; }
.videos .thumb-wrap .yt-icon { font-size: 1.5em;}
    }

    /* Dark mode */
    body.dark-mode {
      background:
        linear-gradient(to right, rgba(15,23,42,0.9), rgba(30,41,59,0.9)),
        repeating-linear-gradient(90deg, #dbeafe 0 20px, #bfdbfe 20px 40px),
        repeating-linear-gradient(0deg, #dbeafe 0 20px, #bfdbfe 20px 40px);
      background-blend-mode: multiply;
      color: #e2e8f0;
    }
    body.dark-mode #gold-sparkles { display: block; }
body.dark-mode #loading-screen { background: rgba(0, 5, 15, 1); 
}
    body.dark-mode .content { background-color: rgba(0, 5, 15, 0.7); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5); }
    body.dark-mode .comic-viewer { background: rgba(0,0,0,0.95); }
    body.dark-mode .copy-note { color: #f8c365; }
    body.dark-mode h2 { color: #f8c365; }
    body.dark-mode .floating-icons a { color: #f8c365; }
    body.dark-mode .floating-icons a:hover { color: #f27b84; }
  </style>
</head>
<body>

<!-- Loading Screen -->
<div id="loading-screen">
  <div class="loading-content">
    <p class="loading-text">Đợi chút!<br>Mini PEACE đang sửa soạn...</p>
    <img src="assets/loading.gif" alt="Loading...">
  </div>
</div>


  <!-- ===== Sparkles overlay (for dark-mode) ===== -->
  <div class="gold-sparkles" id="gold-sparkles"></div>

  <!-- ===== Main content box ===== -->
  <div class="content">
    <p id="portfolio-header" class="portfolio-label"></p>

    <!-- ===== Page1 layers ===== -->
    <div class="overlay-container Page1">
      <!-- layers: keep original z-index values to preserve parallax order -->
      <img id="miniPeace" src="Page1/mini-peace.png" alt="Mini Peace" class="layer" style="z-index: 5;">
      <img id="flags" src="Page1/flags.png" alt="Flags" class="layer" style="z-index: 5;">
      <img id="bubble" src="Page1/bubble.png" alt="Bubble" class="layer" style="z-index: 4;">
      <img id="mtt" src="Page1/mtt.gif" alt="MTT" class="layer" style="z-index: 5;">
      <img id="vase" src="Page1/vase.png" alt="Vase" class="layer" style="z-index: 3;">
      <img id="plant" src="Page1/plant.png" alt="Plant" class="layer" style="z-index: 3;">
      <img id="mushroom" src="Page1/mushroom.png" alt="Mushroom" class="layer" style="z-index: 3;">
      <img id="cactus" src="Page1/cactus.png" alt="Cactus" class="layer" style="z-index: 2;">
      <img id="commission" src="Page1/commission.png" alt="Commission" class="layer" style="z-index: 4;">
      <img id="house" src="Page1/house.png" alt="House" class="layer" style="z-index: 2;">
      <img id="cat" src="Page1/cat.gif" alt="Cat" class="layer" style="z-index: 1;">

      <!-- Fireworks trigger (kept inline positioning as before) -->
      <button id="btn-fireworks"
        style="position:absolute; left:15%; top:68%; transform:translate(-50%,-50%); width:10%; height:10%; padding:5%; background:transparent; border:none; cursor:url('assets/chi.png') 16 16, pointer; z-index:10;">
      </button>

      <!-- Social icons overlay -->
      <div class="icons-overlay">
        <a href="https://www.facebook.com/minipeace2001" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook"></i></a>
        <a href="https://www.instagram.com/minipeace2001/" aria-label="Instagram" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram"></i></a>
        <a href="https://www.behance.net/maithuytien" aria-label="Behance" target="_blank" rel="noopener noreferrer"><i class="fab fa-behance"></i></a>
        <a href="https://www.youtube.com/playlist?list=PLR5fl78Q7K1RJs1C-68pNzut2mKCL2Nod" aria-label="YouTube" target="_blank" rel="noopener noreferrer"><i class="fab fa-youtube"></i></a>
        <a href="javascript:void(0);" class="gmail-icon" onclick="copyEmail(this)" aria-label="Gmail">
  <i class="fab fa-google"></i>
  <span class="copy-note-overlay">Đã copy email</span>
</a>
<a href="javascript:void(0);" class="discord-icon" onclick="copyDiscord(this)" aria-label="Discord">
  <i class="fab fa-discord"></i>
  <span class="copy-note-overlay">Đã copy Discord</span>
</a>
      </div>

      <button id="btn-commission">Commission</button>
    </div>

    <!-- ===== Page2 layers ===== -->
    <div class="overlay-container Page2">
      <img id="so-luoc" src="Page2/so-luoc.png" alt="So Luoc" class="layer" style="z-index: 5;">
      <img id="cat-meme" src="Page2/cat-meme.png" alt="Cat Meme" class="layer" style="z-index: 4;">
      <img id="chibi" src="Page2/chibi.png" alt="Chibi" class="layer" style="z-index: 4;">
      <img id="app" src="Page2/app.png" alt="App" class="layer" style="z-index: 3;">
      <img id="main" src="Page2/main.png" alt="Main" class="layer" style="z-index: 2;">
      <img id="craft" src="Page2/craft.png" alt="Craft" class="layer" style="z-index: 1;">
    </div>

    <!-- ===== Page3 layers + awards + theme toggle ===== -->
    <div class="overlay-container Page3">
      <img id="board" src="Page3/board.png" alt="Board" class="layer" style="z-index: 3;">
      <img id="flower" src="Page3/flower.png" alt="Flower" class="layer" style="z-index: 3;">
      <img id="plant2" src="Page3/plant2.png" alt="Plant2" class="layer" style="z-index: 3;">
      <img id="trophy" src="Page3/trophy.png" alt="Trophy" class="layer" style="z-index: 3;">
      <img id="book" src="Page3/book.png" alt="Book" class="layer" style="z-index: 3;">
      <img id="shelf" src="Page3/shelf.png" alt="Shelf" class="layer" style="z-index: 2;">
      <img id="wall" src="Page3/wall.png" alt="Wall" class="layer" style="z-index: 1;">

      <div class="awards">
        <div class="award-item"><button id="btn-read-wow"><strong>I</strong></button></div>
        <div class="award-item"><button id="btn-read-kaia"><strong>II</strong></button></div>
        <div class="award-item"><button id="btn-read-ava"><strong>III</strong></button></div>
      </div>

      <button id="theme-toggle" class="theme-toggle" aria-label="Chuyển đổi chế độ">
        <i id="theme-icon" class="fas fa-sun"></i>
      </button>
    </div>

    <!-- ===== Page4 layers + embedded videos ===== -->
    <div class="overlay-container Page4">
      <img id="printer" src="Page4/printer.gif" alt="Printer" class="layer" style="z-index: 6;">
      <img id="box" src="Page4/box.png" alt="Box" class="layer" style="z-index: 3;">
      <img id="headphone" src="Page4/headphone.png" alt="Headphone" class="layer" style="z-index: 2;">
      <img id="pen" src="Page4/pen.png" alt="Pen" class="layer" style="z-index: 2;">
      <img id="back" src="Page4/back.png" alt="Back" class="layer" style="z-index: 1;">

    <!-- Vùng video thumbnails -->
<div class="videos">
  <div class="thumb-wrap" id="v1a">
    <img src="https://img.youtube.com/vi/1ux6Nn8Bh3A/hqdefault.jpg"
         alt="v1a" class="video-thumb"
         data-url="https://www.youtube.com/embed/1ux6Nn8Bh3A?autoplay=1">
    <i class="fab fa-youtube yt-icon"></i>
  </div>

  <div class="thumb-wrap" id="v1b">
    <img src="https://img.youtube.com/vi/3_8VEcalmRE/hqdefault.jpg"
         alt="v1b" class="video-thumb"
         data-url="https://www.youtube.com/embed/3_8VEcalmRE?autoplay=1">
    <i class="fab fa-youtube yt-icon"></i>
  </div>

  <div class="thumb-wrap" id="v1c">
    <img src="https://img.youtube.com/vi/1oUTJ3FpdJ8/hqdefault.jpg"
         alt="v1c" class="video-thumb"
         data-url="https://www.youtube.com/embed/1oUTJ3FpdJ8?autoplay=1">
    <i class="fab fa-youtube yt-icon"></i>
  </div>

  <div class="thumb-wrap" id="v2a">
    <img src="https://img.youtube.com/vi/PhKgdZEzMxc/hqdefault.jpg"
         alt="v2a" class="video-thumb"
         data-url="https://www.youtube.com/embed/PhKgdZEzMxc?autoplay=1">
    <i class="fab fa-youtube yt-icon"></i>
  </div>

  <div class="thumb-wrap" id="v2b">
    <img src="https://img.youtube.com/vi/8ka2w0i97Xc/hqdefault.jpg"
         alt="v2b" class="video-thumb"
         data-url="https://www.youtube.com/embed/8ka2w0i97Xc?autoplay=1">
    <i class="fab fa-youtube yt-icon"></i>
  </div>

  <div class="thumb-wrap" id="v2c">
    <img src="https://img.youtube.com/vi/luFUs8uNyvQ/hqdefault.jpg"
         alt="v2c" class="video-thumb"
         data-url="https://www.youtube.com/embed/luFUs8uNyvQ?autoplay=1">
    <i class="fab fa-youtube yt-icon"></i>
  </div>
</div>


<!-- Overlay hiển thị video -->
<div id="videoOverlay">
  <div class="overlay-content">
    <span id="closeOverlay">&times;</span>
    <iframe id="overlayIframe" frameborder="0" allowfullscreen></iframe>
  </div>
</div>

    </div>

    <!-- ===== Page5 layers ===== -->
    <div class="overlay-container Page5">
      <img id="printer2" src="Page5/printer2.png" alt="Printer2" class="layer" style="z-index: 6;">
      <img id="flag" src="Page5/flag.png" alt="Flag" class="layer" style="z-index: 5;">
      <img id="bubble2" src="Page5/bubble2.png" alt="Bubble2" class="layer" style="z-index: 4;">
      <img id="char" src="Page5/char.png" alt="Char" class="layer" style="z-index: 3;">
      <img id="stuff" src="Page5/stuff.png" alt="Stuff" class="layer" style="z-index: 2;">
      <img id="merch" src="Page5/merch.gif" alt="Merch" class="layer" style="z-index: 1;">
      <img id="bg" src="Page5/bg.png" alt="Bg" class="layer" style="z-index: 0;">
    </div>

  </div> <!-- end .content -->

  <!-- ===== Comic viewer modal (initially hidden) ===== -->
  <div id="comicViewer" class="comic-viewer" style="display: none;">
    <div class="comic-blur-bg"></div>
    <button class="close-btn" onclick="closeComicGallery()">✕</button>
    <div class="comic-deck" id="comicDeck"></div>

<!-- Icon nhạc -->
<div id="audio-trigger">
  <i class="fa-solid fa-music"></i>
</div>

<!-- Hint nhạc -->
<div id="audio-hint">Bạn có thể nghe thử nhạc để tăng trải nghiệm đọc</div>

  </div>

  <!-- ===== Audio sources (preload) ===== -->
  <audio id="kaia-audio" src="KAYA/ATCL.mp3" loop preload="auto"></audio>
  <audio id="wow-audio" src="WOW/MTTD.mp3" loop preload="auto"></audio>

  <!-- ===== Floating icons (left) ===== -->
  <div class="floating-icons">
    <a href="https://www.facebook.com/minipeace2001" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook"></i></a>
    <a href="https://www.instagram.com/minipeace2001/" aria-label="Instagram" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram"></i></a>
    <a href="https://www.behance.net/maithuytien" aria-label="Behance" target="_blank" rel="noopener noreferrer"><i class="fab fa-behance"></i></a>
    <a href="https://www.youtube.com/playlist?list=PLR5fl78Q7K1RJs1C-68pNzut2mKCL2Nod" aria-label="YouTube" target="_blank" rel="noopener noreferrer"><i class="fab fa-youtube"></i></a>
    <a href="javascript:void(0);" class="gmail-icon" onclick="copyEmail(this)" aria-label="Gmail">
  <i class="fab fa-google"></i>
  <span class="copy-note-floating">Đã copy email</span>
</a>
<a href="javascript:void(0);" class="discord-icon" onclick="copyDiscord(this)" aria-label="Discord">
  <i class="fab fa-discord"></i>
  <span class="copy-note-floating">Đã copy Discord</span>
</a>
  </div>


  <!-- ======================
       SCRIPTS (giữ toàn bộ chức năng)
       ====================== -->
  <script>
  // Tất cả mã khởi tạo và event listeners đều được đặt trong 1 lần DOMContentLoaded
  document.addEventListener("DOMContentLoaded", () => {
    /* ======================
       Global state & selected DOM nodes
       ====================== */
    let comicPages = [];
    let currentPage = 0;

    const viewer = document.getElementById("comicViewer");
    const deck = document.getElementById("comicDeck");
    const audio = document.getElementById("kaia-audio");
    const wowAudio = document.getElementById("wow-audio");
    const floatingIcons = document.querySelector('.floating-icons');
    const overlayIcons = document.querySelector('.icons-overlay');
    const toggleBtn = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');
    const sparklesContainer = document.getElementById("gold-sparkles");
    const fireworksBtn = document.getElementById('btn-fireworks');

    /* ======================
       Helpers: Sparkles (dark mode)
       - Tạo các phần tử sparkle ngẫu nhiên khi bật dark-mode
       ====================== */
    function createSparkles() {
      if (!sparklesContainer) return;
      sparklesContainer.innerHTML = '';
      const sparkleCount = 30;
      for (let i = 0; i < sparkleCount; i++) {
        const sparkle = document.createElement("div");
        sparkle.classList.add("sparkle");
        if (Math.random() < 0.5) sparkle.classList.add("faint");
        sparkle.style.left = `${Math.random() * 100}%`;
        sparkle.style.bottom = `-${20 + Math.random() * 40}px`;

        const xMove = `${Math.random() * 60 - 30}vw`; // -30vw .. +30vw
        sparkle.style.setProperty('--x-move', xMove);
        sparkle.style.animationName = "floatRandom";
        sparkle.style.animationDuration = `${5 + Math.random() * 10}s`;
        sparkle.style.animationDelay = `${Math.random() * 5}s`;
        sparkle.style.transform = `scale(${0.5 + Math.random() * 1.5}) rotate(${Math.random() * 360}deg)`;

        const size = 6 + Math.random() * 8;
        sparkle.style.width = `${size}px`;
        sparkle.style.height = `${size}px`;

        sparklesContainer.appendChild(sparkle);
      }
    }

    /* ======================
       Theme handling (dark / light)
       - Lưu theme trong localStorage
       - Khi bật dark: tạo sparkles
       ====================== */
    function setTheme(isDark) {
      document.body.classList.toggle('dark-mode', isDark);
      if (themeIcon) {
        themeIcon.classList.toggle('fa-sun', !isDark);
        themeIcon.classList.toggle('fa-moon', isDark);
      }
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      if (isDark) {
        createSparkles();
      } else if (sparklesContainer) {
        sparklesContainer.innerHTML = '';
      }
    }

    // Khởi tạo theme từ storage
    if (toggleBtn && themeIcon) {
      const isDarkMode = localStorage.getItem('theme') === 'dark';
      setTheme(isDarkMode);
      toggleBtn.addEventListener('click', () => {
        const isDark = document.body.classList.contains('dark-mode');
        setTheme(!isDark);
      });
    }

    /* ======================
       Floating icons visibility on scroll
       - Hiện phía ngoài viewport (overlayIcons out of view) thì show floating icons
       ====================== */
    function checkIconsVisibility() {
      if (!overlayIcons || !floatingIcons) return;
      const rect = overlayIcons.getBoundingClientRect();
      const isOutOfView = rect.bottom < 0 || rect.top > window.innerHeight;
      if (isOutOfView) floatingIcons.classList.add("visible");
      else floatingIcons.classList.remove("visible");
    }
    // chạy ngay & khi cuộn/resize
    checkIconsVisibility();
    window.addEventListener('scroll', checkIconsVisibility);
    window.addEventListener('resize', checkIconsVisibility);

    /* ======================
       Copy helpers (email & discord)
       - Ghi chú hiển thị tạm thời khi copy thành công
       ====================== */
window.copyEmail = function(element) {
  const email = "ttien39169@gmail.com";
  navigator.clipboard.writeText(email).then(() => {
    element.classList.add("show-note");
    setTimeout(() => element.classList.remove("show-note"), 2000);
  });
};

window.copyDiscord = function(element) {
  const discordID = "tienmai334";
  navigator.clipboard.writeText(discordID).then(() => {
    element.classList.add("show-note");
    setTimeout(() => element.classList.remove("show-note"), 2000);
  });
};


    /* ======================
       Parallax (desktop only)
       - Dùng mousemove để dịch chuyển các layer .layer
       - Giữ nguyên danh sách layer muốn "không dịch chuyển"
       ====================== */
    if (!/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
      const excluded = ["flags", "house", "commission", "main", "so-luoc", "wall", "back", "pen", "bg", "box", "stuff"];
      document.addEventListener("mousemove", (e) => {
        const containers = document.querySelectorAll(".overlay-container");
        containers.forEach(container => {
          const rect = container.getBoundingClientRect();
          const centerX = rect.left + rect.width / 2;
          const centerY = rect.top + rect.height / 2;
          const offsetX = (e.clientX - centerX) / (rect.width / 2);
          const offsetY = (e.clientY - centerY) / (rect.height / 2);

          const layers = Array.from(container.querySelectorAll(".layer"));
          const depths = layers.map(l => parseInt(l.style.zIndex) || 1);
          const maxDepth = Math.max(...depths);

          layers.forEach(layer => {
            if (excluded.includes(layer.id)) return;
            const depth = parseInt(layer.style.zIndex) || 1;
            const strength = (maxDepth - depth + 1) * 0.5;
            const direction = depth >= maxDepth / 2 ? 1 : -1;
            const moveX = offsetX * strength * direction;
            const moveY = offsetY * strength * direction;
            layer.style.transform = `translate(${moveX}px, ${moveY}px)`;
          });
        });
      });

      // reset transform khi mouseleave
      document.querySelectorAll(".overlay-container").forEach(container => {
        container.addEventListener("mouseleave", () => {
          container.querySelectorAll(".layer").forEach(layer => {
            if (["flags", "house", "commission", "main", "so-luoc", "wall", "back", "pen", "bg", "box", "stuff"].includes(layer.id)) return;
            layer.style.transform = "translate(0,0)";
          });
        });
      });
    }

    /* ======================
       Fireworks effect (khi click btn-fireworks)
       - Tạo nhiều .particle, đặt animation -> remove sau khi animation kết thúc
       ====================== */
    const pastelColors = ['#FFC1CC', '#FFD1A9', '#FFFACD', '#C1FFD7', '#C1D4FF', '#E6C1FF'];
    if (fireworksBtn) {
      fireworksBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        const particlesCount = 150;
        const rect = fireworksBtn.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;

        for (let i = 0; i < particlesCount; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';

          const angle = Math.random() * 2 * Math.PI;
          const speed = Math.random() * 400 + 100;
          const dx = Math.cos(angle) * speed + 'px';
          const dy = Math.sin(angle) * speed + Math.random() * 300 + 150 + 'px';

          particle.style.left = x + 'px';
          particle.style.top = y + 'px';
          particle.style.setProperty('--dx', dx);
          particle.style.setProperty('--dy', dy);

          const color = pastelColors[Math.floor(Math.random() * pastelColors.length)];
          particle.style.background = color;
          particle.style.boxShadow = `0 0 8px ${color}, 0 0 16px ${color}`;

          document.body.appendChild(particle);
          particle.addEventListener('animationend', () => particle.remove());
        }
      });
    }

    /* Commission button -> chuyển trang Comm.html */
    const btnCommission = document.getElementById('btn-commission');
    if (btnCommission) {
      btnCommission.addEventListener('click', () => {
        window.location.href = 'Comm.html';
      });
    }

    /* Page1 commission hover handling (giữ nguyên behavior ban đầu) */
    const page1 = document.querySelector('.overlay-container.Page1');
    const commissionImg = document.getElementById('commission');
    if (page1 && commissionImg) {
      page1.addEventListener('mousemove', (e) => {
        /* trước đây có tính xPercent/yPercent nhưng không dùng; giữ event để có thể mở rộng */
        const rect = page1.getBoundingClientRect();
        const xPercent = ((e.clientX - rect.left) / rect.width) * 100;
        const yPercent = ((e.clientY - rect.top) / rect.height) * 100;
        // (không thay đổi scale ở đây để giữ đúng file gốc)
      });

      page1.addEventListener('mouseleave', () => {
        commissionImg.style.transform = 'scale(1)';
      });
    }

    /* ======================
       Comic viewer logic
       - renderDeck/updateDeck/open/close/fadeOutAudio
       - navigation via click/touch/keyboard
       ====================== */
    function renderDeck(direction = null) {
      const prevImgs = Array.from(deck.querySelectorAll("img"));
      const outgoing = prevImgs.find(img => img.classList.contains("active"));
      if (direction && outgoing) {
        outgoing.classList.remove("active");
        outgoing.classList.add(direction === "left" ? "slide-out-left" : "slide-out-right");
      }
      updateDeck();
    }

    function updateDeck() {
      deck.innerHTML = "";
      comicPages.forEach((src, i) => {
        if (i < currentPage - 1 || i > currentPage + 1) return;
        const img = document.createElement("img");
        img.src = src;
        img.alt = `Page ${i + 1}`;
        img.className = i === currentPage ? "active" : i === currentPage - 1 ? "left" : "right";
        deck.appendChild(img);
      });
    }

    function openComicGallery() {
      currentPage = 0;
      if (viewer) viewer.style.display = "flex";
      renderDeck();
  // hiển thị icon audio
  const audioTrigger = document.getElementById("audio-trigger");
  if (audioTrigger) audioTrigger.style.display = "flex";
    }

    function fadeOutAudio(audioEl) {
      if (!audioEl || audioEl.paused) return;
      let vol = audioEl.volume;
      const fade = setInterval(() => {
        if (vol > 0.05) {
          vol -= 0.05;
          audioEl.volume = vol;
        } else {
          clearInterval(fade);
          audioEl.pause();
          audioEl.currentTime = 0;
          audioEl.volume = 1.0;
        }
      }, 40);
    }

    window.closeComicGallery = function() {
      if (viewer) viewer.style.display = "none";
      fadeOutAudio(audio);
      fadeOutAudio(wowAudio);
    };

    // Close button inside modal (if exists)
    const closeBtn = document.querySelector(".close-btn");
    if (closeBtn) closeBtn.addEventListener("click", closeComicGallery);

    // click on viewer background to close or navigate pages
    if (viewer) viewer.addEventListener("click", handleClick);

    function handleClick(e) {
      if (e.target === viewer || e.target.classList.contains('comic-blur-bg')) {
        closeComicGallery();
        return;
      }
      const x = e.clientX;
      const half = window.innerWidth / 2;
      if (x < half && currentPage > 0) {
        currentPage--;
        renderDeck("right");
      } else if (x >= half && currentPage < comicPages.length - 1) {
        currentPage++;
        renderDeck("left");
      }
    }

    // Keyboard navigation
    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight" && currentPage < comicPages.length - 1) {
        currentPage++;
        renderDeck("left");
      } else if (e.key === "ArrowLeft" && currentPage > 0) {
        currentPage--;
        renderDeck("right");
      } else if (e.key === "Escape") {
        closeComicGallery();
      }
    });

    // Touch swipe navigation
    let xDown = null;
    if (viewer) {
      viewer.addEventListener("touchstart", evt => { xDown = evt.touches[0].clientX; }, false);
      viewer.addEventListener("touchend", evt => {
        if (!xDown) return;
        const xUp = evt.changedTouches[0].clientX;
        const xDiff = xDown - xUp;
        if (xDiff > 50 && currentPage < comicPages.length - 1) {
          currentPage++;
          renderDeck("left");
        } else if (xDiff < -50 && currentPage > 0) {
          currentPage--;
          renderDeck("right");
        }
        xDown = null;
      }, false);
    }

    /* ======================
       Buttons to open comics + audio handling
       ====================== */
const audioTrigger = document.getElementById("audio-trigger");
const audioHint = document.getElementById("audio-hint");
let currentAudio = null; // audio đang bật

audioTrigger.addEventListener("click", (e) => {
  e.stopPropagation(); // tránh trigger chuyển trang
  if (!currentAudio) return;

  if (currentAudio.paused) {
    currentAudio.currentTime = 0; // load lại từ đầu
    currentAudio.play().then(() => {
      audioTrigger.classList.add("active"); // đổi màu khi bật
    }).catch(err => console.warn("Audio error:", err));
  } else {
    currentAudio.pause();
    audioTrigger.classList.remove("active"); // trở về màu gốc khi tắt
  }
});

// Hiển thị hint tạm thời 5s
function showAudioHint() {
  audioHint.classList.add("show");
  setTimeout(() => audioHint.classList.remove("show"), 5000);
}

// Khi mở truyện, show hint
showAudioHint();



    const btnWow = document.getElementById("btn-read-wow");
if (btnWow) {
  btnWow.addEventListener("click", () => {
    fadeOutAudio(audio);
    fadeOutAudio(wowAudio);
    currentAudio = wowAudio; // lưu audio đang mở
    comicPages = ["WOW/01.webp", "WOW/02.webp", "WOW/03.webp", "WOW/04.webp", "WOW/05.webp", "WOW/06.webp"];
    openComicGallery();
  });
}

const btnKaia = document.getElementById("btn-read-kaia");
if (btnKaia) {
  btnKaia.addEventListener("click", () => {
    fadeOutAudio(wowAudio);
    currentAudio = audio; // lưu audio đang mở
    comicPages = ["KAYA/01.webp", "KAYA/02.webp", "KAYA/03.webp", "KAYA/04.webp", "KAYA/05.webp"];
    openComicGallery();
  });
}

const btnAva = document.getElementById("btn-read-ava");
if (btnAva) {
  btnAva.addEventListener("click", () => {
    fadeOutAudio(audio);
    fadeOutAudio(wowAudio);
    currentAudio = null; // không có audio cho AVA
    comicPages = ["AVA/01.webp","AVA/02.webp","AVA/03.webp","AVA/04.webp","AVA/05.webp",
                  "AVA/06.webp","AVA/07.webp","AVA/08.webp","AVA/09.webp","AVA/10.webp","AVA/11.webp"];
    openComicGallery();
  });
}

window.closeComicGallery = function() {
  if (viewer) viewer.style.display = "none";
  fadeOutAudio(audio);
  fadeOutAudio(wowAudio);

  // ẩn icon khi đóng
  const audioTrigger = document.getElementById("audio-trigger");
  if (audioTrigger) audioTrigger.style.display = "none";
};


    /* ======================
       Preload comic images (không bắt buộc nhưng tốt để UX)
       ====================== */
    const preloadImages = [
      "WOW/01.webp","WOW/02.webp","WOW/03.webp","WOW/04.webp","WOW/05.webp","WOW/06.webp",
      "KAYA/01.webp","KAYA/02.webp","KAYA/03.webp","KAYA/04.webp","KAYA/05.webp",
      "AVA/01.webp","AVA/02.webp","AVA/03.webp","AVA/04.webp","AVA/05.webp","AVA/06.webp",
      "AVA/07.webp","AVA/08.webp","AVA/09.webp","AVA/10.webp","AVA/11.webp"
    ];
    preloadImages.forEach(src => {
      const img = new Image();
      img.src = src;
    });

    /* ======================
       Service Worker registration (PWA support)
       ====================== */
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("/service-worker.js")
          .then((registration) => {
            console.log("Service Worker registered with scope:", registration.scope);
          })
          .catch((error) => {
            console.log("Service Worker registration failed:", error);
          });
      });
    }

  }); // end DOMContentLoaded

// Video YOUTUBE
// ======================
// Video Overlay Logic
// ======================
document.addEventListener("DOMContentLoaded", () => {
  const thumbs = document.querySelectorAll(".video-thumb");
  const overlay = document.getElementById("videoOverlay");
  const iframe = document.getElementById("overlayIframe");
  const closeBtn = document.getElementById("closeOverlay");

  thumbs.forEach(thumb => {
    thumb.onclick = (e) => {
      e.preventDefault();   // chắc chắn chặn hành vi mặc định
      e.stopPropagation();  // chắc chắn chặn lan ra ngoài

      iframe.src = thumb.dataset.url;
      overlay.style.display = "flex";
    };
  });

  closeBtn.onclick = () => {
    iframe.src = ""; // dừng video khi đóng
    overlay.style.display = "none";
  };
});


// Đóng overlay khi bấm ra ngoài khung video
if (videoOverlay) {
  videoOverlay.addEventListener("click", (e) => {
    if (e.target === videoOverlay) {
      videoOverlay.style.display = "none";
      overlayIframe.src = "";
    }
  });
}

const commissionImg = document.getElementById("commission");
const btnCommissionHover = document.getElementById("btn-commission");

if (btnCommissionHover && commissionImg) {
  btnCommissionHover.addEventListener("mouseenter", () => {
    commissionImg.classList.add("swaying");
  });
  btnCommissionHover.addEventListener("mouseleave", () => {
    commissionImg.classList.remove("swaying");
  });
}

// LOADING SCREEN!!!
document.addEventListener("DOMContentLoaded", () => {
  const loadingScreen = document.getElementById("loading-screen");
  if (!loadingScreen) return;

  const startTime = Date.now(); // thời điểm bắt đầu hiển thị loading

  function hideLoading() {
    const elapsed = Date.now() - startTime;
    const remaining = 1800 - elapsed; // đảm bảo thời gian loading

    setTimeout(() => {
      loadingScreen.classList.add("hidden");
      setTimeout(() => {
        loadingScreen.remove(); // remove khỏi DOM sau khi fade xong
      }, 500); // 1s trùng với CSS transition
    }, remaining > 0 ? remaining : 0);
  }

  window.addEventListener("load", hideLoading);
});

  </script>
</body>
</html>
