<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mini Peace Commissions</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #fefaef;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: sans-serif;
    }

body.dark {
  background-color: #00050f; /* dark mode */
}
    .main-image {
      margin-top: 20px;
 width: 65vw;   /* chiếm 65% chiều ngang màn hình */
  height: auto;  /* giữ tỉ lệ gốc */
  display: block;
    }

.back-btn {
  position: fixed;
  top: 20px;   /* cách mép trên 20px */
  left: 20px;     /* cách mép trái 20px */
  width: 100px;    /* chỉnh kích thước nút */
  height: 100px;
  background: url('Comm/back.png') no-repeat center center;
  background-size: contain;
  border: none;
  cursor: pointer;
  z-index: 1000;  /* luôn nằm trên cùng */
}

  .menu {
  margin-top: 40px;
  display: flex;
  justify-content: space-between; /* giãn cách đều trong 90% */
  width: 90vw;
}

canvas.flag {
  width: 15%;             /* 6 cái x 15% ≈ 90% */
  height: auto;
  cursor: pointer;
}

  </style>
</head>
<body>
  <img src="Comm/comm.png" alt="Main Image" class="main-image">

  <div class="menu">
    <canvas class="flag" data-src="Comm/flag1.png"></canvas>
    <canvas class="flag" data-src="Comm/flag2.png"></canvas>
    <canvas class="flag" data-src="Comm/flag3.png"></canvas>
    <canvas class="flag" data-src="Comm/flag4.png"></canvas>
    <canvas class="flag" data-src="Comm/flag5.png"></canvas>
    <canvas class="flag" data-src="Comm/flag6.png"></canvas>
  </div>

<a href="index.html" class="back-btn" title="Quay lại trang chủ"></a>

  <script>
 class WavingFlag {
  constructor(canvas, src) {
    this.canvas = canvas;
    this.ctx = canvas.getContext('2d');
    this.img = new Image();
    this.img.src = src;
    this.img.onload = () => {
      this.canvas.width = this.img.width;
      this.canvas.height = this.img.height;
      this.start();
    };
    this.time = 0;
  }

  start() {
    this.width = this.canvas.width;
    this.height = this.canvas.height;
    requestAnimationFrame(() => this.animate());
  }

  animate() {
    const ctx = this.ctx;
    const { width, height } = this;
    ctx.clearRect(0, 0, width, height);

    let topHeight = height * 0.2;       // 20% trên cố định
    let waveHeight = height - topHeight;

    // Vẽ phần trên không rung
    ctx.drawImage(
      this.img,
      0, 0, this.img.width, this.img.height * (topHeight / height),
      0, 0, width, topHeight
    );

    // Vẽ phần dưới (có sóng ngang)
    let syStart = this.img.height * (topHeight / height);
    let sh = this.img.height - syStart;

    let rowHeight = 15; // độ dày mỗi lát (px)
    let rowCount = Math.floor(waveHeight / rowHeight);

    for (let y = 0; y < rowCount; y++) {
      let progress = y / rowCount; 
      // offset ngang, biên độ tăng dần từ 0 ở trên → max ở dưới
      let offset = Math.sin(this.time * 1.5 + y * 0.25) * 2 * progress;

      ctx.drawImage(
        this.img,
        0, syStart + (sh * y / rowCount), this.img.width, sh / rowCount,
        offset, topHeight + y * rowHeight, width, rowHeight
      );
    }

    this.time += 0.025;
    requestAnimationFrame(() => this.animate());
  }
}

    document.querySelectorAll('canvas.flag').forEach(canvas => {
      let src = canvas.getAttribute('data-src');
      new WavingFlag(canvas, src);
    });

  // Khôi phục trạng thái theme đã lưu từ index.html
  window.addEventListener('load', () => {
    const theme = localStorage.getItem('theme');
    if (theme === 'dark') {
      document.body.classList.add('dark');
    }
  });

  </script>
</body>
</html>
